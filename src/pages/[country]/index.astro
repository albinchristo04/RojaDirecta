---
import Layout from '../../layouts/Layout.astro';
import MatchCard from '../../components/MatchCard.astro';
import { getMatches, groupMatchesByLeague } from '../../utils/data';
import { getRotatingTitle } from '../../utils/seo';

export async function getStaticPaths() {
  const countries = [
    { code: 'es', name: 'España', keyword: 'fútbol español' },
    { code: 'mx', name: 'México', keyword: 'fútbol mexicano' },
    { code: 'ar', name: 'Argentina', keyword: 'fútbol argentino' },
    { code: 'co', name: 'Colombia', keyword: 'fútbol colombiano' },
    { code: 'pe', name: 'Perú', keyword: 'fútbol peruano' }
  ];

  return countries.map((country) => ({
    params: { country: country.code },
    props: { country },
  }));
}

const { country } = Astro.props;
const matches = await getMatches();
const groupedMatches = groupMatchesByLeague(matches);

const title = getRotatingTitle(`Roja Directa En Vivo ${country.name}`, 'hub');
const description = `Ver fútbol en vivo en ${country.name} hoy. Disfruta de todos los partidos de ${country.keyword} y ligas internacionales gratis en Roja Directa En Vivo.`;
---

<Layout title={title} description={description} headerTitle={`FÚTBOL EN VIVO ${country.name.toUpperCase()}`}>
    <div class="container">
        <div class="schedule-box">
            <div class="schedule-header">
                PARTIDOS EN VIVO EN {country.name.toUpperCase()}
            </div>
            <div class="matches-list">
                {Object.entries(groupedMatches).map(([league, leagueMatches]) => (
                    <div class="league-section">
                        <div class="league-name">{league}</div>
                        {leagueMatches.map((match) => (
                            <MatchCard match={match} />
                        ))}
                    </div>
                ))}
            </div>
        </div>

        <section class="seo-content">
            <div class="content-box">
                <h2>¿Cómo ver fútbol gratis en {country.name}?</h2>
                <p>
                    En {country.name}, la pasión por el fútbol se vive intensamente. Por eso, en <strong>Roja Directa En Vivo</strong> 
                    hemos optimizado nuestra plataforma para que los aficionados de {country.name} puedan disfrutar de sus equipos 
                    favoritos con la mejor latencia y calidad de imagen.
                </p>
            </div>
        </section>
    </div>
</Layout>

<style>
    .schedule-box {
        background: #222;
        border-radius: 8px;
        overflow: hidden;
        margin-top: 2rem;
        border: 1px solid #333;
    }

    .schedule-header {
        background: #1a1a1a;
        color: #ffc107;
        padding: 1rem;
        text-align: center;
        font-weight: 800;
        font-size: 1.1rem;
        border-bottom: 2px solid #d32f2f;
    }

    .matches-list {
        background: white;
    }

    .league-section {
        border-bottom: 2px solid #eee;
    }

    .league-name {
        background: #f4f4f4;
        color: #333;
        padding: 0.5rem 1rem;
        font-weight: 700;
        font-size: 0.9rem;
        text-transform: uppercase;
    }

    .seo-content {
        margin-top: 3rem;
        background: white;
        color: #333;
        padding: 2rem;
        border-radius: 8px;
        border-left: 5px solid #d32f2f;
    }

    .seo-content h2 {
        color: #d32f2f;
        margin-bottom: 1rem;
        font-size: 1.5rem;
    }

    .seo-content p {
        margin-bottom: 1rem;
        line-height: 1.8;
    }
</style>
